{
  "hooks": {
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx -y dude-claude-plugin auto-retrieve",
            "timeout": 60
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "matcher": "Plan",
        "hooks": [
          {
            "type": "agent",
            "prompt": "Event data: $ARGUMENTS\n\nA Plan subagent has finished. Read the plan transcript at the \"agent_transcript_path\" path from the event data. Read the last 200 lines to understand the plan.\n\nBLOCK the stop (ok: false) with reason:\n\"Please use the dude:upsert_record tool to save this plan as a specification: kind=spec, title=<plan title>, body=<plan details and steps>, status=open\"\n\nIf you cannot read the transcript or extract a meaningful plan, ALLOW the stop (ok: true).",
            "timeout": 120
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "agent",
            "prompt": "Event data: $ARGUMENTS\n\nCheck the \"stop_hook_active\" field. If it is true, return decision: ALLOW (ok: true). Do not read any files.\n\nOtherwise, read the transcript file at the \"transcript_path\" path from the event data. Read the last 200 lines to understand what work was done.\n\nClassify the work into exactly one category:\n- Bug fix → kind=issue, status=resolved\n- Architectural change (new patterns, restructuring, API design) → kind=arch, status=resolved\n- Feature update or improvement → kind=update, status=resolved\n- New specification or plan (not yet implemented) → kind=spec, status=open\n- Completing a planned spec → kind=spec, status=resolved\n- Trivial Q&A, chat, or unclassifiable → no action needed\n\nIf you classified the work, BLOCK the stop (ok: false) with reason:\n\"Please use the dude:upsert_record tool to save this work record: kind=<kind>, title=<concise title>, body=<brief summary of what was done>, status=<status>\"\n\nIf no classification is needed (trivial/unclassifiable), ALLOW the stop (ok: true).",
            "timeout": 120
          }
        ]
      }
    ]
  }
}
